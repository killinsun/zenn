---
title: "Strawberry GraphQLã§ã‚­ãƒ£ãƒƒãƒã—ãŸä¾‹å¤–ãƒ»ã‚¨ãƒ©ãƒ¼ã‚’ Rollbar ã«ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ãã§ãƒ¬ãƒãƒ¼ãƒˆã™ã‚‹"
emoji: "ğŸ›ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python", "GraphQL", "strawberry", "strawberry-graphql", "rollbar"]
published: true
---

Strawberry GraphQL ã‚’ä½¿ã£ãŸQuery, Mutation ã®ã‚¨ãƒ©ãƒ¼ã‚„ä¾‹å¤–ãŒ Rollbar ã«ãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œãªã‹ã£ãŸã®ã§èª¿ã¹ãŸã€‚å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ã€ä»¥ä¸‹ã®Qiitaã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã‚’å®Ÿè£…ã—ã€ã‚ªãƒ¼ãƒãƒ©ã‚¤ãƒ‰ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã§ `rollbar.report_exc_info` ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã†ã¾ãã„ã£ãŸã€‚

- [Strawberry (GraphQL)ã§ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ã®ã¿ã‚’ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹](https://qiita.com/nassy20/items/534ee5e069e2ed35d093)
- [Schema | Strawberry GraphQL](https://strawberry.rocks/docs/types/schema)

## ã‚³ãƒ¼ãƒ‰

```python
class CustomSchema(Schema):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

    def process_errors(
        self,
        errors: List[GraphQLError],
        execution_context: Optional[ExecutionContext] = None,
    ):
        for error in errors:
            StrawberryLogger.error(error, execution_context=execution_context)

            rollbar.report_exc_info(
                exc_info=(
                    error.original_error,
                    error.original_error.__str__(),
                    error.original_error.__traceback__,
                ),
                extra_data={ # ä»¥ä¸‹ã¯ãŠå¥½ã¿ã§
                    "original_error": error.original_error,
                    "context": execution_context.context.__dict__,
                    "execution_context": execution_context.__dict__,
                    "result": (
                        execution_context.result.data
                        if execution_context.result
                        else None
                    ),
                },
            )
```

`exc_info`ã«ã¯ã€`sys.exc_info()` ã‚’æ¸¡ã™ã“ã¨ã§ã‚¨ãƒ©ãƒ¼å‹ã‚„ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒæ¸¡ã•ã‚Œã‚‹ä»•çµ„ã¿ã ãŒã€`process_errors`ã§è£œè¶³ã—ã¦ã„ã‚‹æ™‚ç‚¹ã§ã¯æ­£å¸¸ã«ã‚¨ãƒ©ãƒ¼ãŒå–ã‚Œãªã‹ã£ãŸãŸã‚ã€`errors` / `error` ãŒã‚‚ã£ã¦ã„ã‚‹ `original_error` ã®ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã€ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ `sys.exc_info()`ã®æˆ»ã‚Šå€¤ã«åˆã‚ã›ãŸã‚¿ãƒ—ãƒ«ã«ã™ã‚‹ã“ã¨ã§ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ãã§ãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚

ãã®ã»ã‹ã¯å…ƒã®å‚è€ƒè¨˜äº‹ã¨åŒã˜ãªã®ã§å‰²æ„›ã€‚

## å‚è€ƒ

- [Strawberry (GraphQL)ã§ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ã®ã¿ã‚’ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹](https://qiita.com/nassy20/items/534ee5e069e2ed35d093)
- [Pythonã®ä¾‹å¤–å‹ã‚„ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèªã™ã‚‹](https://qiita.com/taumu/items/7248ac508c2f84ed8ec7)
- [Schema | Strawberry GraphQL](https://strawberry.rocks/docs/types/schema)
